{
    "tags": [
        "oauth-2.0",
        "blazor"
    ],
    "owner": {
        "reputation": 1355,
        "user_id": 4971859,
        "user_type": "registered",
        "accept_rate": 30,
        "profile_image": "https://i.stack.imgur.com/C4KE3.png?s=128&g=1",
        "display_name": "Steve",
        "link": "https://stackoverflow.com/users/4971859/steve"
    },
    "is_answered": true,
    "view_count": 317,
    "accepted_answer_id": 63325080,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1597015137,
    "creation_date": 1596952304,
    "last_edit_date": 1597015137,
    "question_id": 63322946,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/63322946/exception-occurred-while-processing-message-system-invalidoperationexception-i",
    "title": "Exception occurred while processing message. System.InvalidOperationException: IDX20803: Unable to obtain configuration from: &#39;[PII is hidden",
    "body": "<p>I am following this <a href=\"https://auth0.com/blog/securing-blazor-webassembly-apps/#Securing-the-API-with-Auth0\" rel=\"nofollow noreferrer\">tutorial</a> which secures my Blazor WebAssembly Apps with Auth2.com and I am using command line to run the program. I could completed all the steps successfully and I could the Blazor app. But for the last step, I got this error from the command line</p>\n<pre><code>Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler[3]\n      Exception occurred while processing message. System.InvalidOperationException: IDX20803: Unable to obtain configuration from: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.  ---&gt; System.ArgumentException: IDX20108: The address specified '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' is not valid as per HTTPS scheme. Please specify an https address for security reasons. If you want to test with http address, set the RequireHttps property  on IDocumentRetriever to false. (Parameter 'address')\n</code></pre>\n<p>and in my browser console, I get error below:\n<a href=\"https://i.stack.imgur.com/xH8YI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xH8YI.png\" alt=\"enter image description here\" /></a></p>\n<p>This is QuizViewer.razor which consume the API</p>\n<pre><code>@page &quot;/quizViewer&quot;\n@attribute [Authorize]\n@using QuizManagerClientHosted.Shared\n@using System.Net.Http.Json\n\n@using Microsoft.AspNetCore.Components.WebAssembly.Authentication\n@using System.Net.Http.Headers\n\n@inject HttpClient Http\n@inject IAccessTokenProvider TokenProvider \n\n&lt;h1&gt;Take your quiz!&lt;/h1&gt;\n&lt;p&gt;Your current score is @currentScore&lt;/p&gt;\n\n@if (quiz == null)\n{\n    &lt;p&gt;&lt;em&gt;Loading...&lt;/em&gt;&lt;/p&gt;\n}\nelse\n{\n    int quizIndex = 0;\n    @foreach (var quizItem in quiz)\n    {\n        &lt;section&gt;\n            &lt;h3&gt;@quizItem.Question&lt;/h3&gt;\n            &lt;div class=&quot;form-check&quot;&gt;\n                @{\n                    int choiceIndex = 0;\n                    quizScores.Add(0);\n                }\n                @foreach (var choice in quizItem.Choices)\n                {\n                    int currentQuizIndex = quizIndex;\n                    &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;@quizIndex&quot; value=&quot;@choiceIndex&quot; @onchange=&quot;@((eventArgs) =&gt; UpdateScore(Convert.ToInt32(eventArgs.Value), currentQuizIndex))&quot; /&gt;@choice&lt;br&gt;\n\n                    choiceIndex++;\n                }\n            &lt;/div&gt;\n        &lt;/section&gt;\n\n        quizIndex++;\n    }\n}\n\n\n@code {\n    List&lt;QuizItem&gt; quiz;\n    List&lt;int&gt; quizScores = new List&lt;int&gt;();\n    int currentScore = 0;\n\n    protected override async Task OnInitializedAsync()\n    {\n\n        using (var requestMessage = new HttpRequestMessage(HttpMethod.Get, &quot;quiz&quot;))\n        {\n            var tokenResult = await TokenProvider.RequestAccessToken();\n\n            if (tokenResult.TryGetToken(out var token))\n            {\n                requestMessage.Headers.Authorization =\n                  new AuthenticationHeaderValue(&quot;Bearer&quot;, token.Value);\n                var response = await Http.SendAsync(requestMessage);\n                quiz = await response.Content.ReadFromJsonAsync&lt;List&lt;QuizItem&gt;&gt;();\n            }\n        }\n\n    }\n\n    void UpdateScore(int chosenAnswerIndex, int quizIndex)\n    {\n        var quizItem = quiz[quizIndex];\n\n        if (chosenAnswerIndex == quizItem.AnswerIndex)\n        {\n            quizScores[quizIndex] = quizItem.Score;\n        }\n        else\n        {\n            quizScores[quizIndex] = 0;\n        }\n        currentScore = quizScores.Sum();\n    }\n}\n</code></pre>\n<p>and this is the API controller</p>\n<pre><code>using QuizManagerClientHosted.Shared;\nusing System.Collections.Generic;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Authorization;\n\nnamespace QuizManagerClientHosted.Server.Controllers\n{\n    [ApiController]\n    [Route(&quot;[controller]&quot;)]\n    [Authorize]\n    public class QuizController : ControllerBase\n    {\n        private static readonly List&lt;QuizItem&gt; Quiz = new List&lt;QuizItem&gt; {\n            new QuizItem\n                {\n                    Question = &quot;Which of the following is the name of a Leonardo da Vinci's masterpiece?&quot;,\n                    Choices = new List&lt;string&gt; {&quot;Sunflowers&quot;, &quot;Mona Lisa&quot;, &quot;The Kiss&quot;},\n                    AnswerIndex = 1,\n                    Score = 3\n                },\n                new QuizItem\n                {\n                    Question = &quot;Which of the following novels was written by Miguel de Cervantes?&quot;,\n                    Choices = new List&lt;string&gt; {&quot;The Ingenious Gentleman Don Quixote of La Mancia&quot;, &quot;The Life of Gargantua and of Pantagruel&quot;, &quot;One Hundred Years of Solitude&quot;},\n                    AnswerIndex = 0,\n                    Score = 5\n                }\n            };\n\n        [HttpGet]\n        public List&lt;QuizItem&gt; Get()\n        {\n            return Quiz;\n        }\n    }\n}\n</code></pre>\n<p>and Server startup.cs</p>\n<pre><code>using Microsoft.AspNetCore.Builder;\nusing Microsoft.AspNetCore.Hosting;\nusing Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Hosting;\nusing Microsoft.AspNetCore.Authentication.JwtBearer;\n\nnamespace QuizManagerClientHosted.Server\n{\n  public class Startup\n  {\n    public Startup(IConfiguration configuration)\n    {\n      Configuration = configuration;\n    }\n\n    public IConfiguration Configuration { get; }\n\n    public void ConfigureServices(IServiceCollection services)\n    {\n      services.AddAuthentication(options =&gt;\n      {\n        options.DefaultAuthenticateScheme = JwtBearerDefaults.AuthenticationScheme;\n        options.DefaultChallengeScheme = JwtBearerDefaults.AuthenticationScheme;\n      }).AddJwtBearer(options =&gt;\n      {\n        options.Authority = Configuration[&quot;Auth0:Authority&quot;];\n        options.Audience = Configuration[&quot;Auth0:ApiIdentifier&quot;];\n      });\n\n      services.AddControllersWithViews();\n      services.AddRazorPages();\n    }\n\n    public void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n    {\n      if (env.IsDevelopment())\n      {\n        app.UseDeveloperExceptionPage();\n        app.UseWebAssemblyDebugging();\n      }\n      else\n      {\n        app.UseExceptionHandler(&quot;/Error&quot;);\n    \n        app.UseHsts();\n      }\n\n      app.UseHttpsRedirection();\n      app.UseBlazorFrameworkFiles();\n      app.UseStaticFiles();\n\n      app.UseRouting();\n\n      app.UseAuthentication();\n      app.UseAuthorization();\n\n      app.UseEndpoints(endpoints =&gt;\n      {\n        endpoints.MapRazorPages();\n        endpoints.MapControllers();\n        endpoints.MapFallbackToFile(&quot;index.html&quot;);\n      });\n    }\n  }\n}\n</code></pre>\n<p>How do I fix this? Which part I configure wrongly?</p>\n"
}