{
    "tags": [
        "blazor",
        "blazor-webassembly",
        "blazor-hosted"
    ],
    "owner": {
        "reputation": 224,
        "user_id": 5141561,
        "user_type": "registered",
        "accept_rate": 80,
        "profile_image": "https://graph.facebook.com/926750996976/picture?type=large",
        "display_name": "JoeyD",
        "link": "https://stackoverflow.com/users/5141561/joeyd"
    },
    "is_answered": true,
    "view_count": 414,
    "accepted_answer_id": 64907087,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1607415484,
    "creation_date": 1605727673,
    "question_id": 64900028,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/64900028/blazor-wasm-hosted-prerender-with-authentication-authenticationstateprovider-not",
    "title": "Blazor Wasm Hosted Prerender with Authentication AuthenticationStateProvider not registered",
    "body": "<p>I have an out of the box VS Template using Blazor WebAssembly Hosted with Authentication and have converted it over to use PreRendering. However, in doing so it looks like there are a lot of services that are included in the client side that are not provided on the server side.   Here is the exception</p>\n<blockquote>\n<p>An unhandled exception occurred while processing the request.\nInvalidOperationException: Cannot provide a value for property\n'AuthenticationStateProvider' on type\n'Microsoft.AspNetCore.Components.Authorization.CascadingAuthenticationState'.\nThere is no registered service of type\n'Microsoft.AspNetCore.Components.Authorization.AuthenticationStateProvider'.\nMicrosoft.AspNetCore.Components.ComponentFactory+&lt;&gt;c__DisplayClass6_0.g__Initialize|2(IServiceProvider\nserviceProvider, IComponent component)</p>\n<p>Stack Query Cookies Headers Routing InvalidOperationException: Cannot\nprovide a value for property 'AuthenticationStateProvider' on type\n'Microsoft.AspNetCore.Components.Authorization.CascadingAuthenticationState'.\nThere is no registered service of type\n'Microsoft.AspNetCore.Components.Authorization.AuthenticationStateProvider'.\nMicrosoft.AspNetCore.Components.ComponentFactory+&lt;&gt;c__DisplayClass6_0.g__Initialize|2(IServiceProvider\nserviceProvider, IComponent component)\nMicrosoft.AspNetCore.Components.ComponentFactory.PerformPropertyInjection(IServiceProvider\nserviceProvider, IComponent instance)\nMicrosoft.AspNetCore.Components.ComponentFactory.InstantiateComponent(IServiceProvider\nserviceProvider, Type componentType)\nMicrosoft.AspNetCore.Components.RenderTree.Renderer.InstantiateChildComponentOnFrame(ref\nRenderTreeFrame frame, int parentComponentId)\nMicrosoft.AspNetCore.Components.RenderTree.RenderTreeDiffBuilder.InitializeNewComponentFrame(ref\nDiffContext diffContext, int frameIndex)\nMicrosoft.AspNetCore.Components.RenderTree.RenderTreeDiffBuilder.InitializeNewSubtree(ref\nDiffContext diffContext, int frameIndex)\nMicrosoft.AspNetCore.Components.RenderTree.RenderTreeDiffBuilder.InsertNewFrame(ref\nDiffContext diffContext, int newFrameIndex)\nMicrosoft.AspNetCore.Components.RenderTree.RenderTreeDiffBuilder.AppendDiffEntriesForRange(ref\nDiffContext diffContext, int oldStartIndex, int oldEndIndexExcl, int\nnewStartIndex, int newEndIndexExcl)\nMicrosoft.AspNetCore.Components.RenderTree.RenderTreeDiffBuilder.ComputeDiff(Renderer\nrenderer, RenderBatchBuilder batchBuilder, int componentId,\nArrayRange oldTree, ArrayRange\nnewTree)\nMicrosoft.AspNetCore.Components.Rendering.ComponentState.RenderIntoBatch(RenderBatchBuilder\nbatchBuilder, RenderFragment renderFragment)\nMicrosoft.AspNetCore.Components.RenderTree.Renderer.RenderInExistingBatch(RenderQueueEntry\nrenderQueueEntry)\nMicrosoft.AspNetCore.Components.RenderTree.Renderer.ProcessRenderQueue()\nMicrosoft.AspNetCore.Components.Rendering.HtmlRenderer.HandleException(Exception\nexception)\nMicrosoft.AspNetCore.Components.RenderTree.Renderer.ProcessRenderQueue()\nMicrosoft.AspNetCore.Components.RenderTree.Renderer.ProcessPendingRender()\nMicrosoft.AspNetCore.Components.RenderTree.Renderer.AddToRenderQueue(int\ncomponentId, RenderFragment renderFragment)\nMicrosoft.AspNetCore.Components.ComponentBase.StateHasChanged()\nMicrosoft.AspNetCore.Components.ComponentBase.CallOnParametersSetAsync()\nMicrosoft.AspNetCore.Components.ComponentBase.RunInitAndSetParametersAsync()\nMicrosoft.AspNetCore.Components.Rendering.HtmlRenderer.HandleException(Exception\nexception)\nMicrosoft.AspNetCore.Components.RenderTree.Renderer.AddToPendingTasks(Task\ntask)\nMicrosoft.AspNetCore.Components.Rendering.ComponentState.SetDirectParameters(ParameterView\nparameters)\nMicrosoft.AspNetCore.Components.RenderTree.Renderer.RenderRootComponentAsync(int\ncomponentId, ParameterView initialParameters)\nMicrosoft.AspNetCore.Components.Rendering.HtmlRenderer.CreateInitialRenderAsync(Type\ncomponentType, ParameterView initialParameters)\nMicrosoft.AspNetCore.Components.Rendering.HtmlRenderer.RenderComponentAsync(Type\ncomponentType, ParameterView initialParameters)\nMicrosoft.AspNetCore.Components.Rendering.RendererSynchronizationContext+&lt;&gt;c__11+&lt;b__11_0&gt;d.MoveNext()\nMicrosoft.AspNetCore.Mvc.ViewFeatures.StaticComponentRenderer.PrerenderComponentAsync(ParameterView\nparameters, HttpContext httpContext, Type componentType)\nMicrosoft.AspNetCore.Mvc.ViewFeatures.ComponentRenderer.PrerenderedWebAssemblyComponentAsync(HttpContext\ncontext, Type type, ParameterView parametersCollection)\nMicrosoft.AspNetCore.Mvc.ViewFeatures.ComponentRenderer.RenderComponentAsync(ViewContext\nviewContext, Type componentType, RenderMode renderMode, object\nparameters)\nMicrosoft.AspNetCore.Mvc.TagHelpers.ComponentTagHelper.ProcessAsync(TagHelperContext\ncontext, TagHelperOutput output)\nMicrosoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner.g__Awaited|0_0(Task\ntask, TagHelperExecutionContext executionContext, int i, int count)\nBBQFriend.Server.Pages.Pages__Host.b__9_1() in\n_Host.cshtml\n+\n\nMicrosoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()\nBBQFriend.Server.Pages.Pages__Host.ExecuteAsync()\nMicrosoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage\npage, ViewContext context)\nMicrosoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage\npage, ViewContext context, bool invokeViewStarts)\nMicrosoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext\ncontext)\nMicrosoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext\nviewContext, string contentType, Nullable statusCode)\nMicrosoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext\nviewContext, string contentType, Nullable statusCode)\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.g__Awaited|29_0&lt;TFilter,\nTFilterAsync&gt;(ResourceInvoker invoker, Task lastTask, State next,\nScope scope, object state, bool isCompleted)\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed\ncontext)\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext&lt;TFilter,\nTFilterAsync&gt;(ref State next, ref Scope scope, ref object state, ref\nbool isCompleted)\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.g__Awaited|24_0(ResourceInvoker\ninvoker, Task lastTask, State next, Scope scope, object state, bool\nisCompleted)\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed\ncontext)\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(ref State\nnext, ref Scope scope, ref object state, ref bool isCompleted)\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()\nMicrosoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.g__Awaited|17_0(ResourceInvoker\ninvoker, Task task, IDisposable scope)\nMicrosoft.AspNetCore.Routing.EndpointMiddleware.g__AwaitRequestTask|6_0(Endpoint\nendpoint, Task requestTask, ILogger logger)\nMicrosoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext\ncontext)\nMicrosoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext\ncontext)\nIdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext\ncontext, IEndpointRouter router, IUserSession session, IEventService\nevents, IBackChannelLogoutService backChannelLogoutService)\nIdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext\ncontext, IAuthenticationSchemeProvider schemes)\nMicrosoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext\ncontext) IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext\ncontext)\nMicrosoft.AspNetCore.Builder.Extensions.MapWhenMiddleware.Invoke(HttpContext\ncontext)\nMicrosoft.AspNetCore.Builder.Extensions.MapMiddleware.Invoke(HttpContext\ncontext)\nMicrosoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext\ncontext)\nMicrosoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext\ncontext)</p>\n</blockquote>\n<p>What services can I register in the Server startup.cs to Register the necessary services?</p>\n"
}